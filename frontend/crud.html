<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>CRUD Admin</title>
  <script src="https://unpkg.com/react@18/umd/react.development.js" crossorigin></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.development.js" crossorigin></script>
  <script src="https://unpkg.com/babel-standalone@6/babel.min.js"></script>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; }
    table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    th, td { border: 1px solid #ddd; padding: 8px; text-align: center; }
    th { background-color: #f2f2f2; }
    button { margin: 2px; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">

    const { useState, useEffect } = React;

    function CRUD() {
      const [users, setUsers] = useState([]);
      const [nombre, setNombre] = useState('');
      const [email, setEmail] = useState('');
      const [rol, setRol] = useState('user');
      const [editingId, setEditingId] = useState(null);

      // Simulación de fetch inicial desde backend
      useEffect(() => {
        fetchUsers();
      }, []);

      const fetchUsers = async () => {
        // Aquí deberías hacer fetch a tu backend real
        // Por ejemplo: const res = await fetch('http://localhost:4000/users')
        // Simulamos datos iniciales
        setUsers([
          { id: 1, nombre: 'Lina', email: 'lina@mail.com', rol: 'admin' },
          { id: 2, nombre: 'Juan', email: 'juan@mail.com', rol: 'user' }
        ]);
      };

      const addUser = () => {
        if (!nombre || !email) return;
        if (editingId) {
          setUsers(users.map(u => u.id === editingId ? { ...u, nombre, email, rol } : u));
          setEditingId(null);
        } else {
          const newUser = { id: Date.now(), nombre, email, rol };
          setUsers([...users, newUser]);
        }
        setNombre(''); setEmail(''); setRol('user');
      };

      const editUser = (user) => {
        setNombre(user.nombre);
        setEmail(user.email);
        setRol(user.rol);
        setEditingId(user.id);
      };

      const deleteUser = (id) => {
        setUsers(users.filter(u => u.id !== id));
      };

      return (
        <div>
          <h1>CRUD Administrador</h1>
          <div>
            <input placeholder="Nombre" value={nombre} onChange={e => setNombre(e.target.value)} />
            <input placeholder="Correo" value={email} onChange={e => setEmail(e.target.value)} />
            <select value={rol} onChange={e => setRol(e.target.value)}>
              <option value="user">Usuario</option>
              <option value="admin">Administrador</option>
            </select>
            <button onClick={addUser}>{editingId ? 'Guardar' : 'Agregar'}</button>
          </div>
          <table>
            <thead>
              <tr>
                <th>ID</th>
                <th>Nombre</th>
                <th>Correo</th>
                <th>Rol</th>
                <th>Acciones</th>
              </tr>
            </thead>
            <tbody>
              {users.map(u => (
                <tr key={u.id}>
                  <td>{u.id}</td>
                  <td>{u.nombre}</td>
                  <td>{u.email}</td>
                  <td>{u.rol}</td>
                  <td>
                    <button onClick={() => editUser(u)}>Editar</button>
                    <button onClick={() => deleteUser(u.id)}>Eliminar</button>
                  </td>
                </tr>
              ))}
            </tbody>
          </table>
        </div>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<CRUD />);

  </script>
</body>
</html>
